<div class="invoice-view-container fade-in" *ngIf="invoice">
  <div class="invoice-header">
    <div class="invoice-company">
      <h2>Votre Entreprise</h2>
      <p>123 Rue de la Mercerie</p>
      <p>Dakar, Sénégal</p>
      <p>Tél: +221 77 123 45 67</p>
    </div>
    <div class="invoice-info">
      <div class="info-row">
        <span class="info-label">N° Facture:</span>
        <span class="info-value">{{ invoice.invoice_number }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Date:</span>
        <span class="info-value">{{ invoice.issue_date | date:'short' }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Statut:</span>
        <span class="status-badge" [class.paid]="invoice.payment_status === 'paid'" [class.pending]="invoice.payment_status === 'pending'">
          {{ invoice.payment_status === 'paid' ? 'Payée' : 'En attente' }}
        </span>
      </div>
    </div>
  </div>

  <div class="invoice-client">
    <h3>Client</h3>
    <p class="client-name">{{ invoice.customer_name }}</p>
    <p *ngIf="invoice.customer_info?.contact">{{ invoice.customer_info.contact }}</p>
  </div>

  <div class="invoice-items">
    <table>
      <thead>
        <tr>
          <th>Produit</th>
          <th>Quantité</th>
          <th>Prix unitaire</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of invoice.items">
          <td>{{ item.product_name || item.name || 'Produit' }}</td>
          <td>{{ item.quantity }} {{ item.unit || '' }}</td>
          <td>{{ item.unit_price | currencyFormat }}</td>
          <td class="item-total">{{ item.subtotal | currencyFormat }}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="subtotal-row">
          <td colspan="3" class="total-label">Sous-total</td>
          <td class="total-amount">{{ invoice.subtotal | currencyFormat }}</td>
        </tr>
        <tr class="tax-row">
          <td colspan="3" class="total-label">TVA (18%)</td>
          <td class="total-amount">{{ invoice.tax | currencyFormat }}</td>
        </tr>
        <tr class="total-row">
          <td colspan="3" class="total-label">Total</td>
          <td class="total-amount">{{ invoice.total | currencyFormat }}</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div class="invoice-footer">
    <div class="invoice-shop">
      <p><strong>Boutique:</strong> {{ invoice.shop_name || 'N/A' }}</p>
    </div>
    <div class="invoice-notes">
      <p>Merci de votre achat !</p>
    </div>
  </div>

  <div class="invoice-actions">
    <button (click)="printInvoice()" class="btn btn-primary">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path d="M5 2h10v4h2v2h-2v8H5V8H3V6h2V2zm2 2v12h6V4H7zm-2 4h10v6H5V8z" fill="currentColor"/>
      </svg>
      Imprimer
    </button>
    <button (click)="downloadPdf()" class="btn btn-secondary">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
        <path d="M10 2v6h6l-6-6zm-2 0H4v16h12v-8h-6V2zm2 10v2h4v-2h-4zm0 4v2h4v-2h-4z" fill="currentColor"/>
      </svg>
      Télécharger PDF
    </button>
  </div>
</div>

<div *ngIf="isLoading" class="loading-container">
  <p>Chargement de la facture...</p>
</div>
