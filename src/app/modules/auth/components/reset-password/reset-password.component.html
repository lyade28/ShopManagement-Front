<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="logo">
        <svg width="48" height="48" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
          <path d="M16 8L20 14H12L16 8Z" fill="white"/>
          <path d="M10 20L14 26H6L10 20Z" fill="white"/>
          <path d="M22 20L26 26H18L22 20Z" fill="white"/>
          <defs>
            <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32" gradientUnits="userSpaceOnUse">
              <stop stop-color="#6366f1"/>
              <stop offset="1" stop-color="#8b5cf6"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1>Réinitialiser le mot de passe</h1>
      <p class="subtitle">Entrez votre nouveau mot de passe</p>
    </div>

    <div *ngIf="!isSuccess" class="auth-form">
      <div *ngIf="errorMessage" class="error-message">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2" fill="none"/>
          <path d="M10 6v4M10 14h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        {{ errorMessage }}
      </div>

      <form (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="password">Nouveau mot de passe</label>
          <div class="input-wrapper">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <rect x="3" y="8" width="14" height="8" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M6 8V5a4 4 0 0 1 8 0v3" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <input 
              [type]="showPassword ? 'text' : 'password'" 
              id="password" 
              [(ngModel)]="password" 
              name="password"
              class="form-input"
              placeholder="Minimum 8 caractères"
              autocomplete="new-password"
              required
              [disabled]="isLoading"
              minlength="8"
            />
            <button 
              type="button" 
              class="toggle-password"
              (click)="togglePasswordVisibility()"
              tabindex="-1"
            >
              <svg *ngIf="!showPassword" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 3C6 3 3 5.5 1 8c2 2.5 5 5 9 5s7-2.5 9-5c-2-2.5-5-5-9-5z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <circle cx="10" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
              <svg *ngIf="showPassword" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M1 1l18 18M10 3C6 3 3 5.5 1 8c1-1.5 2.5-2.8 4.5-3.7M19 8c-2-2.5-5-5-9-5-1.2 0-2.3.2-3.3.6M10 13c-1.2 0-2.3-.3-3.3-.8M15 11.5c.5-.8.8-1.7.8-2.7" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <circle cx="10" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="passwordConfirm">Confirmer le mot de passe</label>
          <div class="input-wrapper">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <rect x="3" y="8" width="14" height="8" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M6 8V5a4 4 0 0 1 8 0v3" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <input 
              [type]="showPasswordConfirm ? 'text' : 'password'" 
              id="passwordConfirm" 
              [(ngModel)]="passwordConfirm" 
              name="passwordConfirm"
              class="form-input"
              placeholder="Confirmez votre mot de passe"
              autocomplete="new-password"
              required
              [disabled]="isLoading"
            />
            <button 
              type="button" 
              class="toggle-password"
              (click)="togglePasswordConfirmVisibility()"
              tabindex="-1"
            >
              <svg *ngIf="!showPasswordConfirm" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 3C6 3 3 5.5 1 8c2 2.5 5 5 9 5s7-2.5 9-5c-2-2.5-5-5-9-5z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <circle cx="10" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
              <svg *ngIf="showPasswordConfirm" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M1 1l18 18M10 3C6 3 3 5.5 1 8c1-1.5 2.5-2.8 4.5-3.7M19 8c-2-2.5-5-5-9-5-1.2 0-2.3.2-3.3.6M10 13c-1.2 0-2.3-.3-3.3-.8M15 11.5c.5-.8.8-1.7.8-2.7" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <circle cx="10" cy="8" r="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
            </button>
          </div>
        </div>

        <button 
          type="submit" 
          class="btn btn-primary btn-block"
          [disabled]="isLoading || !password || !passwordConfirm || password !== passwordConfirm"
        >
          <span *ngIf="!isLoading">Réinitialiser le mot de passe</span>
          <span *ngIf="isLoading" class="loading">
            <svg class="spinner" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" stroke-dasharray="50" stroke-dashoffset="25" fill="none">
                <animateTransform attributeName="transform" type="rotate" values="0 10 10;360 10 10" dur="1s" repeatCount="indefinite"/>
              </circle>
            </svg>
            Réinitialisation...
          </span>
        </button>
      </form>
    </div>

    <div *ngIf="isSuccess" class="success-message">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" fill="rgba(16, 185, 129, 0.1)"/>
        <path d="M9 12l2 2 4-4" stroke="var(--success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h3>Mot de passe réinitialisé !</h3>
      <p>Votre mot de passe a été réinitialisé avec succès.</p>
      <p class="hint">Vous allez être redirigé vers la page de connexion...</p>
      <button (click)="backToLogin()" class="btn btn-primary btn-block">
        Aller à la connexion
      </button>
    </div>

    <div class="auth-footer">
      <p>Vous vous souvenez de votre mot de passe ? <a routerLink="/auth/login">Se connecter</a></p>
    </div>
  </div>
</div>
